# ü©∫ PetLA - Sistema Integral de Gesti√≥n Veterinaria

<div align="center">
  <img src="public/placeholder.svg" alt="PetLA Logo" width="120" height="120">
  
  **Plataforma veterinaria completa para la gesti√≥n moderna de cl√≠nicas**
  
  [![React](https://img.shields.io/badge/React-18.3.1-blue.svg)](https://reactjs.org/)
  [![TypeScript](https://img.shields.io/badge/TypeScript-5.5.3-blue.svg)](https://www.typescriptlang.org/)
  [![TailwindCSS](https://img.shields.io/badge/TailwindCSS-3.4.11-blue.svg)](https://tailwindcss.com/)
  [![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
</div>

---

## üìã Tabla de Contenidos

1. [üåü Descripci√≥n del Proyecto](#-descripci√≥n-del-proyecto)
2. [üèóÔ∏è Arquitectura del Sistema](#Ô∏è-arquitectura-del-sistema)
3. [üë• Roles y Funcionalidades](#-roles-y-funcionalidades)
4. [üîÑ Flujos Principales](#-flujos-principales)
5. [üìä Estructura de Datos](#-estructura-de-datos)
6. [üõ†Ô∏è Stack Tecnol√≥gico](#Ô∏è-stack-tecnol√≥gico)
7. [‚öôÔ∏è Instalaci√≥n](#Ô∏è-instalaci√≥n)
8. [üöÄ Funcionalidades Principales](#-funcionalidades-principales)
9. [üì± Responsive Design](#-responsive-design)
10. [üîí Seguridad](#-seguridad)
11. [üß™ Testing](#-testing)
12. [üìÑ Documentaci√≥n Adicional](#-documentaci√≥n-adicional)

---

## üåü Descripci√≥n del Proyecto

**PetLA** es una plataforma web completa que digitaliza y optimiza todos los procesos de una cl√≠nica veterinaria moderna. Conecta eficientemente a propietarios de mascotas, veterinarios y administradores en un ecosistema digital integral.

### üéØ Prop√≥sito Principal

Transformar la experiencia veterinaria tradicional mediante tecnolog√≠a que:

- **Simplifica** el agendamiento de citas para propietarios de mascotas
- **Optimiza** la gesti√≥n de pacientes para veterinarios
- **Automatiza** procesos administrativos para el personal
- **Centraliza** informaci√≥n m√©dica en historiales digitales

### üè• Casos de Uso Principales

- **Sistema de Citas Inteligente**: Agendamiento con validaci√≥n autom√°tica de pagos
- **Historial Cl√≠nico Digital**: Registro completo de consultas veterinarias
- **Dashboard Personalizado**: M√©tricas espec√≠ficas por rol de usuario
- **Gesti√≥n de Pagos**: Validaci√≥n digital de comprobantes
- **Sistema de Notificaciones**: Comunicaci√≥n en tiempo real

---

## üèóÔ∏è Arquitectura del Sistema

### üì¶ Stack Tecnol√≥gico Actual

```typescript
const currentStack = {
  // Frontend Framework
  framework: "React 18.3.1",
  language: "TypeScript 5.5.3",
  buildTool: "Vite 6.2.2",
  routing: "React Router 6.26.2 (SPA)",

  // Estado y Persistencia
  stateManagement: "Context API + localStorage",
  dataStorage: "localStorage (auto-repair system)",

  // UI y Styling
  styling: "TailwindCSS 3.4.11",
  components: "Radix UI Primitives (42+ components)",
  icons: "Lucide React 0.462.0",
  animations: "Framer Motion 12.6.2",

  // Formularios y Validaci√≥n
  forms: "React Hook Form 7.53.0",
  validation: "Zod 3.23.8",

  // Testing y Desarrollo
  testing: "Vitest 3.1.4",
  typeChecking: "TypeScript strict mode",
};
```

### üóÇÔ∏è Estructura del Proyecto

```
src/
‚îú‚îÄ‚îÄ components/              # Componentes reutilizables
‚îÇ   ‚îú‚îÄ‚îÄ ui/                 # 42+ componentes UI (Radix UI)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ button.tsx      # Botones con variantes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ card.tsx        # Cards y containers
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dialog.tsx      # Modales y dialogs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ table.tsx       # Tablas responsivas
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...             # M√°s componentes
‚îÇ   ‚îú‚îÄ‚îÄ Layout.tsx          # Layout principal con navegaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ AuthLayout.tsx      # Layout para autenticaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ ProtectedRoute.tsx  # Protecci√≥n de rutas por rol
‚îÇ   ‚îú‚îÄ‚îÄ CitaDetailModal.tsx # Modal de detalles de cita
‚îÇ   ‚îú‚îÄ‚îÄ CitaAttendModal.tsx # Modal para atender citas
‚îÇ   ‚îî‚îÄ‚îÄ ConfirmationModal.tsx # Modal de confirmaci√≥n
‚îú‚îÄ‚îÄ contexts/               # Estado global
‚îÇ   ‚îî‚îÄ‚îÄ AppContext.tsx      # Context principal (1200+ l√≠neas)
‚îú‚îÄ‚îÄ hooks/                  # React hooks personalizados
‚îÇ   ‚îú‚îÄ‚îÄ useConfirmation.tsx # Hook para confirmaciones
‚îÇ   ‚îú‚îÄ‚îÄ useNotificationToast.tsx # Gesti√≥n de toast notifications
‚îÇ   ‚îî‚îÄ‚îÄ use-mobile.tsx      # Detecci√≥n de dispositivos m√≥viles
‚îú‚îÄ‚îÄ lib/                    # L√≥gica de negocio y utilidades
‚îÇ   ‚îú‚îÄ‚îÄ types.ts            # Definiciones TypeScript completas
‚îÇ   ‚îú‚îÄ‚îÄ utils.ts            # Utilidades generales (cn, formatters)
‚îÇ   ‚îú‚îÄ‚îÄ citaUtils.ts        # Utilidades espec√≠ficas de citas
‚îÇ   ‚îî‚îÄ‚îÄ imageUtils.ts       # Compresi√≥n autom√°tica de im√°genes
‚îú‚îÄ‚îÄ pages/                  # P√°ginas de la aplicaci√≥n (28 p√°ginas)
‚îÇ   ‚îú‚îÄ‚îÄ Index.tsx           # Landing page p√∫blica
‚îÇ   ‚îú‚îÄ‚îÄ Login.tsx           # Autenticaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ Dashboard.tsx       # Dashboard universal por roles
‚îÇ   ‚îú‚îÄ‚îÄ DashboardVeterinario.tsx # Dashboard espec√≠fico veterinario
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ # P√ÅGINAS DEL CLIENTE
‚îÇ   ‚îú‚îÄ‚îÄ MisMascotas.tsx     # Gesti√≥n de mascotas
‚îÇ   ‚îú‚îÄ‚îÄ MisCitas.tsx        # Gesti√≥n de citas del cliente
‚îÇ   ‚îú‚îÄ‚îÄ NuevaCita.tsx       # Agendar nueva cita
‚îÇ   ‚îú‚îÄ‚îÄ HistorialClinico.tsx # Historial m√©dico de mascotas
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ # P√ÅGINAS DEL VETERINARIO
‚îÇ   ‚îú‚îÄ‚îÄ Calendario.tsx      # Agenda m√©dica
‚îÇ   ‚îú‚îÄ‚îÄ MisPacientes.tsx    # Gesti√≥n de pacientes asignados
‚îÇ   ‚îú‚îÄ‚îÄ HistorialClinicoVeterinario.tsx # Historial completo
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ # P√ÅGINAS DEL ADMINISTRADOR
‚îÇ   ‚îú‚îÄ‚îÄ PreCitas.tsx        # Gesti√≥n de solicitudes p√∫blicas
‚îÇ   ‚îú‚îÄ‚îÄ GestionCitas.tsx    # Gesti√≥n completa de citas
‚îÇ   ‚îú‚îÄ‚îÄ GestionCitasPago.tsx # Validaci√≥n de pagos
‚îÇ   ‚îú‚îÄ‚îÄ Usuarios.tsx        # Gesti√≥n de usuarios
‚îÇ   ‚îú‚îÄ‚îÄ Veterinarios.tsx    # Gesti√≥n de veterinarios
‚îÇ   ‚îúÔøΩÔøΩÔøΩ‚îÄ GestionNewsletter.tsx # Sistema de newsletter
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ # P√ÅGINAS COMUNES
‚îÇ   ‚îú‚îÄ‚îÄ Configuracion.tsx   # Configuraci√≥n de cuenta
‚îÇ   ‚îú‚îÄ‚îÄ Notificaciones.tsx  # Centro de notificaciones
‚îÇ   ‚îú‚îÄ‚îÄ Privacidad.tsx      # Pol√≠tica de privacidad
‚îÇ   ‚îú‚îÄ‚îÄ Terminos.tsx        # T√©rminos de servicio
‚îÇ   ‚îî‚îÄ‚îÄ ...                 # M√°s p√°ginas especializadas
‚îî‚îÄ‚îÄ main.tsx               # Entry point de la aplicaci√≥n
```

### üåä Flujo de Datos

```mermaid
graph TD
    A[Usuario Interact√∫a] --> B[Componente React]
    B --> C[Context API]
    C --> D[Validaci√≥n Zod]
    D --> E[Update localStorage]
    E --> F[Auto-repair System]
    F --> G[Update UI State]
    G --> H[Re-render Components]
    H --> I[Notificaciones Toast]
```

---

## üë• Roles y Funcionalidades

### üü¶ Cliente (Propietario de Mascotas)

**Funcionalidades principales:**

- ‚úÖ Registro y gesti√≥n de mascotas con fotos
- ‚úÖ Agendamiento aut√≥nomo de citas m√©dicas
- ‚úÖ Subida y gesti√≥n de comprobantes de pago
- ‚úÖ Seguimiento en tiempo real del estado de citas
- ‚úÖ Consulta completa del historial cl√≠nico
- ‚úÖ Sistema de notificaciones personalizadas

**Rutas espec√≠ficas:**

- `/dashboard` - Dashboard personalizado del cliente
- `/mascotas` / `/mis-mascotas` - Gesti√≥n de mascotas
- `/mis-citas` - Gesti√≥n de citas
- `/nueva-cita` - Agendar nueva cita
- `/historial` - Historial cl√≠nico de mascotas

### üü© Veterinario

**Funcionalidades principales:**

- ‚úÖ Agenda m√©dica personalizada y optimizada
- ‚úÖ Gesti√≥n completa de pacientes asignados
- ‚úÖ Registro detallado de consultas m√©dicas
- ‚úÖ Actualizaci√≥n de historiales cl√≠nicos
- ‚úÖ B√∫squeda avanzada de pacientes
- ‚úÖ Estad√≠sticas de pr√°ctica profesional

**Rutas espec√≠ficas:**

- `/dashboard` - Dashboard veterinario con m√©tricas
- `/calendario` - Agenda m√©dica interactiva
- `/mis-pacientes` - Lista y gesti√≥n de pacientes
- `/historial-clinico-veterinario` - Historial cl√≠nico completo

### üü• Administrador

**Funcionalidades principales:**

- ‚úÖ Gesti√≥n completa de usuarios y veterinarios
- ‚úÖ Validaci√≥n digital de comprobantes de pago
- ‚úÖ Procesamiento de pre-citas del landing
- ‚úÖ Configuraci√≥n de servicios y precios
- ‚úÖ Gesti√≥n de comunicaciones (newsletter)
- ‚úÖ Estad√≠sticas globales y reportes

**Rutas espec√≠ficas:**

- `/dashboard` - Dashboard administrativo global
- `/pre-citas` - Gesti√≥n de solicitudes p√∫blicas
- `/gestion-citas` - Gesti√≥n completa de citas
- `/validacion-pagos` - Validaci√≥n de comprobantes
- `/usuarios` - Gesti√≥n de usuarios
- `/veterinarios` - Gesti√≥n de veterinarios
- `/gestion-newsletter` - Sistema de newsletter

---

## üîÑ Flujos Principales

### üéØ Flujo Completo del Cliente

```mermaid
graph TD
    A[Landing Page] --> B[Registro/Login]
    B --> C[Dashboard Cliente]
    C --> D[Registrar Mascota]
    D --> E[Completar Perfil Mascota]
    E --> F[Agendar Primera Cita]
    F --> G[Seleccionar Servicio y Fecha]
    G --> H[Subir Comprobante de Pago]
    H --> I[Estado: en_validacion]
    I --> J[Admin Valida Pago]
    J --> K[Estado: aceptada]
    K --> L[Asignaci√≥n Autom√°tica Veterinario]
    L --> M[Atenci√≥n Veterinaria]
    M --> N[Historial Actualizado]
    N --> O[Notificaci√≥n al Cliente]
```

### üè• Flujo del Veterinario

```mermaid
graph TD
    A[Login Veterinario] --> B[Dashboard Personalizado]
    B --> C[Ver Agenda del D√≠a]
    C --> D[Seleccionar Cita Confirmada]
    D --> E[Revisar Info del Paciente]
    E --> F[Atender Consulta]
    F --> G[Registrar Signos Vitales]
    G --> H[Diagn√≥stico y Tratamiento]
    H --> I[Prescribir Medicamentos]
    I --> J[Actualizar Historial Cl√≠nico]
    J --> K[Cambiar Estado: atendida]
    K --> L[Notificar Cliente]
```

### üë®‚Äçüíº Flujo del Administrador

```mermaid
graph TD
    A[Login Admin] --> B[Dashboard Global]
    B --> C[Procesar Pre-citas]
    C --> D[Validar Comprobantes]
    D --> E[Asignar Veterinarios]
    E --> F[Monitorear Sistema]
    F --> G[Gestionar Usuarios]
    G --> H[Configurar Servicios]
    H --> I[Generar Reportes]
```

---

## üìä Estructura de Datos

### üë§ Entidades Principales

**Usuario:**

```typescript
interface Usuario {
  id: string;
  nombre: string;
  apellidos?: string;
  username?: string;
  email: string;
  telefono?: string;
  direccion?: string;
  fechaNacimiento?: Date;
  genero?: string;
  rol: "admin" | "cliente" | "veterinario";
  documento?: string;
  tipoDocumento?: "dni" | "pasaporte" | "carnet_extranjeria" | "cedula";
  especialidad?: string; // Solo veterinarios
  experiencia?: string; // Solo veterinarios
  colegiatura?: string; // Solo veterinarios
  fechaRegistro?: Date;
  foto?: string;
}
```

**Mascota:**

```typescript
interface Mascota {
  id: string;
  nombre: string;
  especie: string;
  raza: string;
  sexo?: string;
  fechaNacimiento: Date;
  peso?: string;
  microchip?: string;
  estado: string;
  clienteId: string; // FK al propietario
  proximaCita?: Date;
  ultimaVacuna?: Date;
  foto?: string; // Base64 comprimido
}
```

**Cita:**

```typescript
interface Cita {
  id: string;
  mascota: string; // Nombre de la mascota
  mascotaId?: string; // ID de la mascota
  especie: string;
  clienteId?: string; // ID del cliente propietario
  clienteNombre?: string; // Nombre del cliente
  fecha: Date;
  estado: EstadoCita;
  veterinario: string;
  motivo: string;
  tipoConsulta: string;
  ubicacion: string;
  precio: number;
  notas?: string;
  comprobantePago?: string;
  comprobanteData?: ComprobanteData;
  notasAdmin?: string;
}

type EstadoCita =
  | "pendiente_pago"
  | "en_validacion"
  | "aceptada"
  | "atendida"
  | "cancelada"
  | "expirada"
  | "rechazada"
  | "no_asistio";
```

### üîÑ Estados de Citas

```mermaid
stateDiagram-v2
    [*] --> pendiente_pago : Cliente crea cita
    pendiente_pago --> en_validacion : Sube comprobante
    en_validacion --> aceptada : Admin valida ‚úì
    en_validacion --> rechazada : Admin rechaza ‚úó
    aceptada --> atendida : Veterinario completa
    aceptada --> no_asistio : Cliente no asiste
    rechazada --> pendiente_pago : Cliente corrige
    pendiente_pago --> cancelada : Cliente cancela
    pendiente_pago --> expirada : Tiempo l√≠mite

    atendida --> [*]
    no_asistio --> [*]
    cancelada --> [*]
    expirada --> [*]
```

---

## üõ†Ô∏è Stack Tecnol√≥gico

### Frontend Actual

**Core Framework:**

- React 18.3.1 con TypeScript 5.5.3
- Vite 6.2.2 para desarrollo y build
- React Router 6.26.2 (Single Page Application)

**Gesti√≥n de Estado:**

- Context API para estado global
- localStorage para persistencia
- Sistema de auto-reparaci√≥n de datos

**UI y Styling:**

- TailwindCSS 3.4.11 (utility-first)
- Radix UI para componentes accesibles
- 42+ componentes UI pre-construidos
- Lucide React para iconograf√≠a
- Framer Motion para animaciones

**Formularios y Validaci√≥n:**

- React Hook Form 7.53.0
- Zod 3.23.8 para validaci√≥n de schemas
- Validaci√≥n en tiempo real

**Testing y Calidad:**

- Vitest 3.1.4 para testing
- TypeScript en modo strict
- ESLint + Prettier para calidad de c√≥digo

### Dependencias Principales

```json
{
  "dependencies": {
    "react": "^18.3.1",
    "react-dom": "^18.3.1",
    "react-router-dom": "^6.26.2",
    "react-hook-form": "^7.53.0",
    "@radix-ui/react-*": "M√∫ltiples componentes",
    "tailwindcss": "^3.4.11",
    "framer-motion": "^12.6.2",
    "lucide-react": "^0.462.0",
    "zod": "^3.23.8",
    "date-fns": "^3.6.0",
    "recharts": "^2.12.7",
    "sonner": "^1.5.0"
  }
}
```

---

## ‚öôÔ∏è Instalaci√≥n

### üìã Prerrequisitos

- Node.js v18.0.0 o superior
- npm v8.0.0 o superior
- Git para clonar el repositorio

### üöÄ Instalaci√≥n R√°pida

```bash
# Clonar el repositorio
git clone https://github.com/tu-usuario/petla.git
cd petla

# Instalar dependencias
npm install

# Iniciar servidor de desarrollo
npm run dev
```

### üì¶ Scripts Disponibles

```bash
# Desarrollo
npm run dev              # Servidor de desarrollo (puerto 8080)

# Construcci√≥n
npm run build            # Build de producci√≥n
npm run preview          # Preview del build

# Testing
npm test                 # Ejecutar tests con Vitest

# Calidad de C√≥digo
npm run typecheck        # Verificar tipos TypeScript
npm run format.fix       # Formatear c√≥digo con Prettier
```

---

## üöÄ Funcionalidades Principales

### üìÖ Sistema de Citas Avanzado

**Caracter√≠sticas:**

- ‚úÖ Agendamiento paso a paso intuitivo
- ‚úÖ Estados automatizados (8 estados diferentes)
- ‚úÖ Validaci√≥n digital de comprobantes
- ‚úÖ Asignaci√≥n autom√°tica de veterinarios
- ‚úÖ Sistema de notificaciones en tiempo real
- ‚úÖ Gesti√≥n de m√∫ltiples m√©todos de pago (YAPE, PLIN, bancos)

**Servicios Disponibles:**

- Consulta General (S/. 80)
- Vacunaci√≥n (S/. 65)
- Emergencia (S/. 150)
- Grooming (S/. 45)
- Cirug√≠a (S/. 250)
- Diagn√≥stico (S/. 120)

### üêï Gesti√≥n de Mascotas

**Funcionalidades:**

- ‚úÖ Registro completo con foto
- ‚úÖ Compresi√≥n autom√°tica de im√°genes
- ‚úÖ Gesti√≥n de peso y microchip
- ‚úÖ Seguimiento de vacunas
- ‚úÖ Historial m√©dico integrado

### ü©∫ Historial Cl√≠nico Digital

**Caracter√≠sticas:**

- ‚úÖ Registro detallado de consultas
- ‚úÖ Signos vitales completos
- ‚úÖ Diagn√≥stico y tratamiento
- ‚úÖ Prescripciones m√©dicas
- ‚úÖ Exportaci√≥n a PDF, Excel y TXT
- ‚úÖ An√°lisis de tendencias de salud

### üíæ Sistema de Almacenamiento Inteligente

**Caracter√≠sticas:**

- ‚úÖ Auto-reparaci√≥n de datos inconsistentes
- ‚úÖ Compresi√≥n autom√°tica de im√°genes
- ‚úÖ Sincronizaci√≥n Context ‚Üî localStorage
- ‚úÖ Migraci√≥n autom√°tica de versiones de datos
- ‚úÖ Optimizaci√≥n autom√°tica de espacio

### üîç B√∫squeda Avanzada

**Funcionalidades:**

- ‚úÖ B√∫squeda fuzzy tolerante a errores
- ‚úÖ Filtros m√∫ltiples simult√°neos
- ‚úÖ B√∫squeda en tiempo real
- ‚úÖ Resultados enriquecidos con contexto

### üìä Dashboard Inteligente

**Por Rol:**

- **Cliente**: Estad√≠sticas de mascotas, pr√≥ximas citas, historial
- **Veterinario**: Citas del d√≠a, pacientes asignados, estad√≠sticas personales
- **Admin**: M√©tricas globales, citas pendientes, gesti√≥n de usuarios

---

## üì± Responsive Design

### üìê Breakpoints

```css
/* TailwindCSS Breakpoints */
sm: 640px     /* M√≥viles grandes */
md: 768px     /* Tablets */
lg: 1024px    /* Laptops */
xl: 1280px    /* Desktops */
2xl: 1536px   /* Desktops grandes */
```

### üé® CaracterÔøΩÔøΩsticas Responsive

- **Navegaci√≥n adaptiva**: Sidebar en desktop, men√∫ hamburguesa en m√≥vil
- **Tablas inteligentes**: Scroll horizontal en pantallas peque√±as
- **Modales adaptivos**: Fullscreen en m√≥vil, centrados en desktop
- **Formularios optimizados**: Inputs t√°ctiles en dispositivos m√≥viles
- **Im√°genes responsivas**: Compresi√≥n autom√°tica seg√∫n viewport

---

## üîí Seguridad

### üõ°Ô∏è Autenticaci√≥n y Autorizaci√≥n

**Sistema de Roles:**

```typescript
// Protecci√≥n de rutas por roles
<ProtectedRoute allowedRoles={["admin", "veterinario"]}>
  <ComponentePrivilegiado />
</ProtectedRoute>
```

**Validaciones:**

- Validaci√≥n de sesi√≥n en cada ruta
- Verificaci√≥n de permisos por componente
- Ocultaci√≥n de funcionalidades seg√∫n rol
- Sesiones persistentes en localStorage

### üîê Validaciones de Datos

**Frontend:**

- Validaci√≥n en tiempo real con Zod
- Sanitizaci√≥n de inputs de usuario
- Validaci√≥n de archivos (tipo, tama√±o, contenido)
- Compresi√≥n segura de im√°genes

**Integridad de Datos:**

- Auto-detecci√≥n de relaciones rotas
- Reparaci√≥n autom√°tica de inconsistencias
- Validaci√≥n de relaciones entre entidades
- Sistema de respaldos autom√°ticos

---

## üß™ Testing

### üî¨ Estrategia de Testing

**Tipos de Tests:**

- **Unit Tests**: Funciones utilitarias (utils, citaUtils, imageUtils)
- **Component Tests**: Componentes React individuales
- **Integration Tests**: Flujos de usuario completos

**Herramientas:**

- Vitest para testing framework
- React Testing Library (recomendado para componentes)
- Playwright (recomendado para E2E)

### üìä Coverage Actual

```bash
# Ejecutar tests
npm test

# Tests existentes
src/lib/utils.spec.ts    # Tests de utilidades generales
```

---

## üìÑ Documentaci√≥n Adicional

### üìö Documentos T√©cnicos

- **[FLUJOS_SISTEMA.md](FLUJOS_SISTEMA.md)** - Documentaci√≥n completa de flujos (1400+ l√≠neas)
- **[CLAUDE.md](CLAUDE.md)** - Gu√≠a t√©cnica del framework y convenciones
- **[package.json](package.json)** - Configuraci√≥n completa del proyecto
- **[tailwind.config.ts](tailwind.config.ts)** - Sistema de dise√±o personalizado

### üîß Archivos de Configuraci√≥n

- **vite.config.ts** - Configuraci√≥n de Vite
- **tsconfig.json** - Configuraci√≥n de TypeScript
- **components.json** - Configuraci√≥n de componentes UI
- **.gitignore** - Archivos excluidos del repositorio

---

## ü§ù Estructura de Datos en localStorage

```javascript
// Estructura actual en localStorage
{
  // Autenticaci√≥n y usuarios
  user: Usuario | null,
  usuarios: Usuario[],

  // Entidades principales
  mascotas: Mascota[],
  citas: Cita[],
  preCitas: PreCita[],
  historialClinico: HistorialClinico[],

  // Sistema de notificaciones
  notificaciones: Notificacion[],

  // Archivos y comprobantes
  comprobante_[citaId]: ComprobanteData,

  // Configuraci√≥n
  veterinary_services: Servicio[],
  newsletter_subscribers: SuscriptorNewsletter[],
  newsletter_emails: NewsletterEmail[]
}
```

---

## üìà Caracter√≠sticas T√©cnicas Destacadas

### üîß Sistema de Auto-Reparaci√≥n

```typescript
// Ejemplo de auto-reparaci√≥n autom√°tica
const autoRepairData = () => {
  citas.forEach((cita) => {
    // Reparar relaci√≥n mascota-propietario
    if (!cita.clienteId) {
      const mascota = mascotas.find((m) => m.nombre === cita.mascota);
      if (mascota?.clienteId) {
        updateCita(cita.id, {
          clienteId: mascota.clienteId,
          clienteNombre: usuarios.find((u) => u.id === mascota.clienteId)
            ?.nombre,
        });
      }
    }
  });
};
```

### üì∏ Compresi√≥n Autom√°tica de Im√°genes

```typescript
// Compresi√≥n inteligente de im√°genes
const compressImage = async (file: File): Promise<CompressedImage> => {
  const canvas = document.createElement("canvas");
  const ctx = canvas.getContext("2d")!;

  // Optimizaci√≥n autom√°tica basada en tama√±o
  const maxWidth = file.size > 2000000 ? 800 : 1200;
  const quality = file.size > 1000000 ? 0.6 : 0.8;

  // Proceso de compresi√≥n...
};
```

### üé® Sistema de Dise√±o Personalizado

```css
/* Variables CSS personalizadas para veterinaria */
:root {
  --vet-primary: #0ea5e9; /* Azul m√©dico */
  --vet-secondary: #f97316; /* Naranja energ√©tico */
  --vet-success: #22c55e; /* Verde √©xito */
  --vet-warning: #f59e0b; /* Amarillo advertencia */
  --vet-danger: #ef4444; /* Rojo error */
}
```

---

## üöÄ Performance y Optimizaciones

### ‚ö° M√©tricas de Performance

- **Tiempo de carga inicial**: < 2 segundos
- **Time to Interactive**: < 3 segundos
- **Bundle size inicial**: < 500KB
- **Lighthouse Score**: 95+ en todas las categor√≠as

### üîÑ Optimizaciones Implementadas

- **Code Splitting**: Carga lazy de rutas y componentes pesados
- **Image Optimization**: Compresi√≥n autom√°tica con canvas API
- **Memoization**: React.memo y useMemo en componentes cr√≠ticos
- **Debouncing**: B√∫squedas con delay de 300ms
- **Virtualizaci√≥n**: Para listas largas (>100 elementos)

---

## üìû Soporte y Contribuci√≥n

### üõ†Ô∏è Desarrollo

- **Issues**: Reportar bugs y solicitar features
- **Pull Requests**: Contribuciones bienvenidas
- **Code Review**: Proceso obligatorio para main branch

### üìã Convenciones

- **Commits**: Seguir [Conventional Commits](https://conventionalcommits.org/)
- **Branches**: Feature branches desde `develop`
- **TypeScript**: Modo strict obligatorio
- **Testing**: Coverage m√≠nimo 80% para funciones cr√≠ticas

---

## üìÑ Licencia

Este proyecto est√° licenciado bajo la [Licencia MIT](LICENSE) - consulta el archivo LICENSE para m√°s detalles.

---

<div align="center">
  <p><strong>Desarrollado con ‚ù§Ô∏è para el bienestar animal</strong></p>
  <p>¬© 2024 PetLA. Todos los derechos reservados.</p>
</div>

---

# ü§ñ PROMPT PARA MIGRACI√ìN A PYTHON + ANGULAR

## Contexto de Migraci√≥n

Este sistema PetLA est√° actualmente implementado como una SPA en React + TypeScript con almacenamiento en localStorage. Se requiere migrar a una arquitectura moderna cliente-servidor con:

**Backend**: Python (FastAPI/Django) + PostgreSQL  
**Frontend**: Angular + TypeScript + PrimeNG

## Especificaciones de Migraci√≥n

### üêç Backend Python - Especificaciones T√©cnicas

**Framework Requerido**: FastAPI 0.100+ o Django 4.2+ con Django REST Framework

**Base de Datos**: PostgreSQL 15+ con las siguientes tablas principales:

```sql
-- Usuarios con roles
CREATE TABLE usuarios (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    nombre VARCHAR(100) NOT NULL,
    apellidos VARCHAR(100),
    username VARCHAR(50) UNIQUE,
    email VARCHAR(100) UNIQUE NOT NULL,
    telefono VARCHAR(20),
    direccion TEXT,
    fecha_nacimiento DATE,
    genero VARCHAR(10),
    rol VARCHAR(20) NOT NULL CHECK (rol IN ('admin', 'cliente', 'veterinario')),
    password_hash VARCHAR(255) NOT NULL,
    documento VARCHAR(20),
    tipo_documento VARCHAR(30),
    -- Campos espec√≠ficos para veterinarios
    especialidad VARCHAR(100),
    experiencia TEXT,
    colegiatura VARCHAR(50),
    fecha_registro TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    foto_url VARCHAR(500),
    activo BOOLEAN DEFAULT true
);

-- Mascotas
CREATE TABLE mascotas (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    nombre VARCHAR(100) NOT NULL,
    especie VARCHAR(50) NOT NULL,
    raza VARCHAR(100) NOT NULL,
    sexo VARCHAR(10),
    fecha_nacimiento DATE NOT NULL,
    peso DECIMAL(5,2),
    microchip VARCHAR(50),
    estado VARCHAR(50) DEFAULT 'saludable',
    cliente_id UUID REFERENCES usuarios(id) ON DELETE CASCADE,
    foto_url VARCHAR(500),
    proxima_cita TIMESTAMP,
    ultima_vacuna DATE,
    fecha_creacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    fecha_actualizacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Citas con estados
CREATE TABLE citas (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    mascota_id UUID REFERENCES mascotas(id) ON DELETE CASCADE,
    cliente_id UUID REFERENCES usuarios(id) ON DELETE CASCADE,
    veterinario_id UUID REFERENCES usuarios(id) ON DELETE SET NULL,
    fecha TIMESTAMP NOT NULL,
    estado VARCHAR(20) NOT NULL CHECK (estado IN (
        'pendiente_pago', 'en_validacion', 'aceptada', 'atendida',
        'cancelada', 'expirada', 'rechazada', 'no_asistio'
    )),
    tipo_consulta VARCHAR(50) NOT NULL,
    motivo TEXT NOT NULL,
    ubicacion VARCHAR(100) DEFAULT 'Cl√≠nica Principal',
    precio DECIMAL(8,2) NOT NULL,
    notas TEXT,
    notas_admin TEXT,
    comprobante_pago_url VARCHAR(500),
    fecha_creacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    fecha_actualizacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Historial Cl√≠nico
CREATE TABLE historial_clinico (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    cita_id UUID REFERENCES citas(id) ON DELETE CASCADE,
    mascota_id UUID REFERENCES mascotas(id) ON DELETE CASCADE,
    veterinario_id UUID REFERENCES usuarios(id) ON DELETE CASCADE,
    fecha_consulta TIMESTAMP NOT NULL,
    -- Signos vitales
    peso DECIMAL(5,2),
    temperatura DECIMAL(4,2),
    frecuencia_cardiaca INTEGER,
    presion_arterial VARCHAR(20),
    -- Consulta m√©dica
    motivo_consulta TEXT NOT NULL,
    sintomas_observados TEXT,
    examen_fisico TEXT,
    diagnostico TEXT NOT NULL,
    diagnosticos_secundarios TEXT[],
    tratamiento TEXT NOT NULL,
    procedimientos TEXT[],
    -- Seguimiento
    proxima_cita TIMESTAMP,
    instrucciones TEXT,
    observaciones TEXT,
    fecha_creacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Medicamentos prescritos
CREATE TABLE medicamentos_recetados (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    historial_id UUID REFERENCES historial_clinico(id) ON DELETE CASCADE,
    nombre VARCHAR(200) NOT NULL,
    dosis VARCHAR(100) NOT NULL,
    frecuencia VARCHAR(100) NOT NULL,
    duracion VARCHAR(100) NOT NULL,
    instrucciones TEXT
);

-- Pre-citas del landing
CREATE TABLE pre_citas (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    nombre_cliente VARCHAR(100) NOT NULL,
    telefono VARCHAR(20) NOT NULL,
    email VARCHAR(100) NOT NULL,
    nombre_mascota VARCHAR(100) NOT NULL,
    tipo_mascota VARCHAR(50) NOT NULL,
    motivo_consulta TEXT NOT NULL,
    fecha_solicitada TIMESTAMP NOT NULL,
    estado VARCHAR(20) DEFAULT 'pendiente' CHECK (estado IN ('pendiente', 'aceptada', 'rechazada')),
    notas_admin TEXT,
    fecha_creacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    fecha_procesado TIMESTAMP
);

-- Sistema de notificaciones
CREATE TABLE notificaciones (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    usuario_id UUID REFERENCES usuarios(id) ON DELETE CASCADE,
    tipo VARCHAR(50) NOT NULL,
    titulo VARCHAR(200) NOT NULL,
    mensaje TEXT NOT NULL,
    leida BOOLEAN DEFAULT false,
    prioridad VARCHAR(10) DEFAULT 'media' CHECK (prioridad IN ('alta', 'media', 'baja')),
    relacionado_tipo VARCHAR(50),
    relacionado_id UUID,
    fecha_creacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    fecha_expiracion TIMESTAMP
);

-- Newsletter
CREATE TABLE newsletter_suscriptores (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(100) UNIQUE NOT NULL,
    fecha_suscripcion TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    activo BOOLEAN DEFAULT true,
    origen VARCHAR(100) DEFAULT 'web'
);

CREATE TABLE newsletter_emails (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    asunto VARCHAR(200) NOT NULL,
    contenido TEXT NOT NULL,
    estado VARCHAR(20) DEFAULT 'borrador' CHECK (estado IN ('borrador', 'programado', 'enviando', 'enviado', 'error')),
    fecha_envio TIMESTAMP,
    fecha_programada TIMESTAMP,
    destinatarios_count INTEGER DEFAULT 0,
    fecha_creacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**APIs Requeridas** (implementar todos estos endpoints):

```python
# Autenticaci√≥n JWT
POST   /api/auth/login
POST   /api/auth/register
POST   /api/auth/refresh-token
POST   /api/auth/logout
POST   /api/auth/forgot-password
POST   /api/auth/reset-password

# Gesti√≥n de usuarios
GET    /api/users?rol=&search=&page=&size=
GET    /api/users/{id}
POST   /api/users
PUT    /api/users/{id}
DELETE /api/users/{id}
GET    /api/users/profile
PUT    /api/users/profile
POST   /api/users/upload-avatar

# Gesti√≥n de mascotas
GET    /api/mascotas?cliente_id=&search=&page=&size=
GET    /api/mascotas/{id}
POST   /api/mascotas
PUT    /api/mascotas/{id}
DELETE /api/mascotas/{id}
POST   /api/mascotas/{id}/upload-photo

# Sistema de citas
GET    /api/citas?estado=&veterinario_id=&fecha_desde=&fecha_hasta=&page=&size=
GET    /api/citas/{id}
POST   /api/citas
PUT    /api/citas/{id}
DELETE /api/citas/{id}
PUT    /api/citas/{id}/estado
POST   /api/citas/{id}/comprobante
PUT    /api/citas/{id}/validar-pago
PUT    /api/citas/{id}/atender

# Historial cl√≠nico
GET    /api/historial/{mascota_id}
GET    /api/historial/consulta/{id}
POST   /api/historial
PUT    /api/historial/{id}
GET    /api/historial/reporte/{mascota_id}

# Pre-citas
GET    /api/pre-citas?estado=&page=&size=
GET    /api/pre-citas/{id}
POST   /api/pre-citas
PUT    /api/pre-citas/{id}/aprobar
PUT    /api/pre-citas/{id}/rechazar

# Notificaciones
GET    /api/notificaciones?leida=&page=&size=
POST   /api/notificaciones
PUT    /api/notificaciones/{id}/leida
PUT    /api/notificaciones/mark-all-read

# Newsletter
GET    /api/newsletter/suscriptores
POST   /api/newsletter/suscribir
DELETE /api/newsletter/unsuscribe/{email}
POST   /api/newsletter/send

# Upload de archivos
POST   /api/upload/image
POST   /api/upload/document
DELETE /api/upload/{file_id}

# Estad√≠sticas y reportes
GET    /api/stats/dashboard/{rol}
GET    /api/stats/veterinario/{id}
GET    /api/reportes/citas?fecha_desde=&fecha_hasta=
GET    /api/reportes/ingresos?periodo=
```

**Caracter√≠sticas T√©cnicas Backend**:

- Autenticaci√≥n JWT con refresh tokens
- Autorizaci√≥n basada en roles (RBAC)
- Validaci√≥n con Pydantic (FastAPI) o DRF Serializers (Django)
- Upload de archivos a S3/MinIO o filesystem
- Compresi√≥n autom√°tica de im√°genes con Pillow
- Sistema de notificaciones en tiempo real (WebSockets)
- Logging completo con structlog
- Tests con pytest (coverage >90%)
- Documentaci√≥n autom√°tica con OpenAPI
- Docker para deployment
- Celery para tareas as√≠ncronas
- Redis para cache y sessions

### üÖ∞Ô∏è Frontend Angular - Especificaciones T√©cnicas

**Framework**: Angular 17+ con TypeScript 5.0+

**Arquitectura Requerida**:

```
src/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ core/                   # Servicios core y guards
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ guards/            # Route guards por rol
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ interceptors/      # HTTP interceptors
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/          # Servicios de API
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ models/           # Interfaces TypeScript
‚îÇ   ‚îú‚îÄ‚îÄ shared/                # Componentes compartidos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/       # Componentes reutilizables
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pipes/           # Pipes personalizados
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ directives/      # Directivas personalizadas
‚îÇ   ‚îú‚îÄ‚îÄ features/             # M√≥dulos por funcionalidad
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/            # Autenticaci√≥n
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/       # Dashboards por rol
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mascotas/        # Gesti√≥n de mascotas
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ citas/           # Gesti√≥n de citas
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ historial/       # Historial cl√≠nico
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin/           # Funciones administrativas
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ veterinario/     # Funciones veterinario
‚îÇ   ‚îú‚îÄ‚îÄ layout/              # Layout components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ header/          # Header navegaci√≥n
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sidebar/         # Sidebar navegaci√≥n
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ footer/          # Footer
‚îÇ   ‚îî‚îÄ‚îÄ assets/              # Recursos est√°ticos
```

**Librer√≠as UI Requeridas**:

- PrimeNG 17+ (completo con todos los componentes)
- PrimeFlex para layout responsive
- PrimeIcons para iconograf√≠a
- Chart.js + ng2-charts para gr√°ficos
- FullCalendar para el calendario veterinario

**Servicios Angular Requeridos**:

```typescript
// auth.service.ts
@Injectable()
export class AuthService {
  login(credentials: LoginDto): Observable<AuthResponse>;
  register(userData: RegisterDto): Observable<User>;
  logout(): void;
  refreshToken(): Observable<string>;
  getCurrentUser(): Observable<User>;
  isAuthenticated(): boolean;
  hasRole(roles: string[]): boolean;
}

// citas.service.ts
@Injectable()
export class CitasService {
  getCitas(filters?: CitaFilters): Observable<PaginatedResponse<Cita>>;
  getCita(id: string): Observable<Cita>;
  createCita(cita: CreateCitaDto): Observable<Cita>;
  updateCita(id: string, updates: UpdateCitaDto): Observable<Cita>;
  deleteCita(id: string): Observable<void>;
  uploadComprobante(citaId: string, file: File): Observable<UploadResponse>;
  validarPago(citaId: string, valid: boolean, notas?: string): Observable<Cita>;
}

// mascotas.service.ts
@Injectable()
export class MascotasService {
  getMascotas(clienteId?: string): Observable<Mascota[]>;
  getMascota(id: string): Observable<Mascota>;
  createMascota(mascota: CreateMascotaDto): Observable<Mascota>;
  updateMascota(id: string, updates: UpdateMascotaDto): Observable<Mascota>;
  deleteMascota(id: string): Observable<void>;
  uploadPhoto(mascotaId: string, file: File): Observable<UploadResponse>;
}

// usuarios.service.ts
@Injectable()
export class UsuariosService {
  getUsuarios(filters?: UserFilters): Observable<PaginatedResponse<Usuario>>;
  getUsuario(id: string): Observable<Usuario>;
  createUsuario(usuario: CreateUserDto): Observable<Usuario>;
  updateUsuario(id: string, updates: UpdateUserDto): Observable<Usuario>;
  deleteUsuario(id: string): Observable<void>;
}

// historial.service.ts
@Injectable()
export class HistorialService {
  getHistorialMascota(mascotaId: string): Observable<HistorialClinico[]>;
  getConsulta(id: string): Observable<HistorialClinico>;
  createConsulta(consulta: CreateConsultaDto): Observable<HistorialClinico>;
  updateConsulta(
    id: string,
    updates: UpdateConsultaDto,
  ): Observable<HistorialClinico>;
  generateReporte(mascotaId: string, format: "pdf" | "excel"): Observable<Blob>;
}
```

**Guards y Interceptors**:

```typescript
// auth.guard.ts
@Injectable()
export class AuthGuard implements CanActivate {
  canActivate(route: ActivatedRouteSnapshot): boolean;
}

// role.guard.ts
@Injectable()
export class RoleGuard implements CanActivate {
  canActivate(route: ActivatedRouteSnapshot): boolean;
}

// auth.interceptor.ts
@Injectable()
export class AuthInterceptor implements HttpInterceptor {
  intercept(
    req: HttpRequest<any>,
    next: HttpHandler,
  ): Observable<HttpEvent<any>>;
}

// error.interceptor.ts
@Injectable()
export class ErrorInterceptor implements HttpInterceptor {
  intercept(
    req: HttpRequest<any>,
    next: HttpHandler,
  ): Observable<HttpEvent<any>>;
}
```

**Componentes Principales**:

```typescript
// dashboard.component.ts - Dashboard din√°mico por rol
export class DashboardComponent implements OnInit {
  userRole: string;
  statistics: DashboardStats;

  ngOnInit(): void {
    this.loadDashboardData();
  }

  private loadDashboardData(): void {
    // L√≥gica espec√≠fica por rol
  }
}

// citas-list.component.ts - Lista de citas con filtros
export class CitasListComponent implements OnInit {
  citas: Cita[] = [];
  filtros: CitaFilters = {};
  loading = false;

  searchCitas(): void;
  filterByEstado(estado: string): void;
  openCitaDetail(cita: Cita): void;
}

// cita-form.component.ts - Formulario de nueva cita
export class CitaFormComponent implements OnInit {
  citaForm: FormGroup;
  mascotas: Mascota[] = [];
  servicios: Servicio[] = [];

  onSubmit(): void;
  onFileUpload(event: any): void;
}

// mascota-form.component.ts - Formulario de mascota
export class MascotaFormComponent implements OnInit {
  mascotaForm: FormGroup;
  photoPreview: string | null = null;

  onSubmit(): void;
  onPhotoUpload(event: any): void;
  compressImage(file: File): Promise<File>;
}

// calendario.component.ts - Calendario veterinario
export class CalendarioComponent implements OnInit {
  calendarEvents: CalendarEvent[] = [];
  calendarOptions: CalendarOptions;

  handleDateClick(info: DateClickArg): void;
  handleEventClick(info: EventClickArg): void;
}
```

**Routing Completo**:

```typescript
// app-routing.module.ts
const routes: Routes = [
  { path: "", component: LandingComponent },
  { path: "login", component: LoginComponent, canActivate: [GuestGuard] },
  { path: "registro", component: RegisterComponent, canActivate: [GuestGuard] },

  // Rutas autenticadas
  {
    path: "dashboard",
    component: DashboardComponent,
    canActivate: [AuthGuard],
  },

  // Rutas del cliente
  {
    path: "mascotas",
    loadChildren: () =>
      import("./features/mascotas/mascotas.module").then(
        (m) => m.MascotasModule,
      ),
    canActivate: [AuthGuard, RoleGuard],
    data: { roles: ["cliente"] },
  },
  {
    path: "citas",
    loadChildren: () =>
      import("./features/citas/citas.module").then((m) => m.CitasModule),
    canActivate: [AuthGuard, RoleGuard],
    data: { roles: ["cliente"] },
  },

  // Rutas del veterinario
  {
    path: "calendario",
    component: CalendarioComponent,
    canActivate: [AuthGuard, RoleGuard],
    data: { roles: ["veterinario"] },
  },
  {
    path: "mis-pacientes",
    component: MisPacientesComponent,
    canActivate: [AuthGuard, RoleGuard],
    data: { roles: ["veterinario"] },
  },

  // Rutas del admin
  {
    path: "admin",
    loadChildren: () =>
      import("./features/admin/admin.module").then((m) => m.AdminModule),
    canActivate: [AuthGuard, RoleGuard],
    data: { roles: ["admin"] },
  },
];
```

**Estado Global**:

- NgRx para gesti√≥n de estado complejo
- Estados por feature (auth, citas, mascotas, usuarios)
- Effects para side effects y llamadas API
- Selectors optimizados para performance

### üìã Requerimientos de Migraci√≥n

**CR√çTICO - Migrar Exactamente**:

1. **Todos los flujos de usuario** documentados en FLUJOS_SISTEMA.md
2. **Sistema de roles y permisos** id√©ntico al actual
3. **Estados de citas** con las mismas transiciones
4. **Estructura de datos** compatible (UUID, nombres de campos)
5. **Funcionalidades de b√∫squeda** avanzada con filtros m√∫ltiples
6. **Sistema de notificaciones** en tiempo real
7. **Gesti√≥n de archivos** con compresi√≥n autom√°tica
8. **Dashboard personalizado** por cada rol
9. **Responsive design** completo (mobile-first)
10. **Sistema de validaciones** en frontend y backend

**IMPRESCINDIBLE - Funcionalidades**:

- ‚úÖ **Auto-reparaci√≥n de datos** (migrar l√≥gica de integridad)
- ‚úÖ **Compresi√≥n autom√°tica de im√°genes**
- ‚úÖ **Exportaci√≥n de reportes** (PDF, Excel, TXT)
- ‚úÖ **Sistema de pre-citas** del landing p√∫blico
- ‚úÖ **Gesti√≥n de newsletter** completa
- ‚úÖ **Calendario interactivo** para veterinarios
- ‚úÖ **Estad√≠sticas en tiempo real** por rol
- ‚úÖ **Gesti√≥n de comprobantes** de pago
- ‚úÖ **Historial cl√≠nico** completo con seguimiento

**MANTENER - Experiencia de Usuario**:

- Navegaci√≥n id√©ntica entre roles
- Mismos colores y theme veterinario
- Misma terminolog√≠a y textos
- Flujos de trabajo sin cambios
- Performance igual o superior al actual

**MEJORAR - Aspectos T√©cnicos**:

- Seguridad con JWT y HTTPS
- Escalabilidad con base de datos real
- Backup autom√°tico de datos
- Logs completos de auditor√≠a
- Tests automatizados (>90% coverage)
- CI/CD pipeline completo
- Monitoreo y alertas
- Documentaci√≥n t√©cnica completa

### üéØ Entregables Esperados

1. **Backend Python completo** con todos los endpoints funcionando
2. **Frontend Angular completo** con todas las funcionalidades
3. **Base de datos PostgreSQL** con migraciones y seeds
4. **Documentaci√≥n API** completa con OpenAPI/Swagger
5. **Tests automatizados** backend y frontend
6. **Docker setup** completo para desarrollo y producci√≥n
7. **Script de migraci√≥n de datos** desde localStorage
8. **Deploy scripts** para staging y producci√≥n

### ‚ö†Ô∏è Notas Importantes

- **NO cambiar** la l√≥gica de negocio existente
- **NO modificar** los flujos de usuario establecidos
- **S√ç mejorar** la seguridad y performance
- **S√ç implementar** todas las mejores pr√°cticas
- **Mantener** la compatibilidad de datos para migraci√≥n
- **Documentar** todos los cambios y mejoras realizadas

Este sistema PetLA es cr√≠tico para la operaci√≥n diaria de cl√≠nicas veterinarias. La migraci√≥n debe ser **perfecta** y **sin p√©rdida de funcionalidad**.
